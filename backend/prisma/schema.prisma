// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model CollecteCalendrier {
  id           Int      @id @default(autoincrement())
  date         DateTime @unique
  typeCollecte String   // 'jaune', 'gris', 'jaune+gris'
  annee        Int
  mois         Int
  jour         Int
  estFerie     Boolean  @default(false)
  description  String?

  @@index([date])
  @@index([annee, mois])
  @@index([typeCollecte])
  @@map("collecte_calendrier")
}

model JoursFeries {
  id     Int      @id @default(autoincrement())
  date   DateTime @unique
  nom    String
  annee  Int

  @@map("jours_feries")
}

model Utilisateur {
  id            Int               @id @default(autoincrement())
  email         String            @unique
  telephone     String?
  notifEmail    Boolean           @default(true)
  notifSms      Boolean           @default(false)
  timezone      String            @default("Europe/Paris")
  notifications NotificationLog[]

  @@map("utilisateur")
}

model NotificationLog {
  id            Int         @id @default(autoincrement())
  utilisateurId Int
  utilisateur   Utilisateur @relation(fields: [utilisateurId], references: [id])
  type          String      // 'email' | 'sms'
  message       String      @db.Text
  envoyeLe      DateTime    @default(now())
  statut        String      // 'success' | 'failed'

  @@index([utilisateurId])
  @@index([envoyeLe])
  @@map("notification_log")
}
